<!-- src/app/usuario/modificar-usuario/modificar-usuario.component.html -->

<div class="container my-5">
  <div class="card shadow-lg rounded-lg border-0 p-4">
    <h1 class="text-center display-4 fw-bold text-dark mb-4">
      Modificar Mi Perfil
    </h1>

    <div *ngIf="isLoading" class="text-center my-5">
      <div
        class="spinner-border text-primary"
        role="status"
        style="width: 3rem; height: 3rem"
      >
        <span class="visually-hidden">Cargando...</span>
      </div>
      <p class="mt-3 fs-5 text-muted">Cargando datos de tu perfil...</p>
    </div>

    <div
      *ngIf="!isLoading && errorMessage"
      class="alert alert-danger text-center my-4"
      role="alert"
    >
      <p class="mb-0 fs-5">{{ errorMessage }}</p>
      <button class="btn btn-secondary mt-3" routerLink="/user-dashboard">
        Volver
      </button>
    </div>

    <form *ngIf="!isLoading && user" (ngSubmit)="saveChanges()">
      <div class="row g-3">
        <!-- Columna izquierda para campos de texto -->
        <div class="col-md-6">
          <div class="mb-3">
            <label for="nombre" class="form-label">Nombre:</label>
            <input
              type="text"
              class="form-control"
              id="nombre"
              [(ngModel)]="user.nombre"
              name="nombre"
              required
            />
          </div>
          <div class="mb-3">
            <label for="apellido" class="form-label">Apellido:</label>
            <input
              type="text"
              class="form-control"
              id="apellido"
              [(ngModel)]="user.apellido"
              name="apellido"
            />
          </div>
          <div class="mb-3">
            <label for="dni" class="form-label">DNI:</label>
            <input
              type="text"
              class="form-control"
              id="dni"
              [(ngModel)]="user.dni"
              name="dni"
            />
          </div>
          <div class="mb-3">
            <label for="nombreUsuario" class="form-label"
              >Nombre de Usuario:</label
            >
            <input
              type="text"
              class="form-control"
              id="nombreUsuario"
              [(ngModel)]="user.nombreUsuario"
              name="nombreUsuario"
            />
          </div>
        </div>

        <!-- Columna derecha para otros campos -->
        <div class="col-md-6">
          <div class="mb-3">
            <label for="email" class="form-label">Email:</label>
            <!-- El email no se puede modificar desde aquí, solo se muestra -->
            <input
              type="email"
              class="form-control"
              id="email"
              [ngModel]="user.email"
              name="email"
              disabled
            />
            <div class="form-text">
              Para cambiar tu email, por favor, contacta a soporte.
            </div>
          </div>
          <div class="mb-3">
            <label for="edad" class="form-label">Edad:</label>
            <input
              type="number"
              class="form-control"
              id="edad"
              [(ngModel)]="user.edad"
              name="edad"
              required
            />
          </div>
          <div class="mb-3">
            <label for="rol" class="form-label">Rol:</label>
            <!-- El rol no se puede modificar desde aquí, solo se muestra -->
            <input
              type="text"
              class="form-control"
              id="rol"
              [ngModel]="user.rol?.nombre || 'N/A'"
              name="rol"
              disabled
            />
          </div>
        </div>
      </div>

      <div class="d-grid gap-2 d-md-flex justify-content-md-end mt-4">
        <button
          type="submit"
          class="btn btn-primary btn-lg"
          [disabled]="isSaving"
        >
          <span
            *ngIf="isSaving"
            class="spinner-border spinner-border-sm me-2"
            role="status"
            aria-hidden="true"
          ></span>
          {{ isSaving ? "Guardando..." : "Guardar Cambios" }}
        </button>
        <button type="button" class="btn btn-secondary btn-lg" routerLink="/">
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Enlace al CDN de Bootstrap CSS -->
<link
  href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
  rel="stylesheet"
  xintegrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
  crossorigin="anonymous"
/>

<!-- Estilos CSS personalizados (mínimos) -->
<style>
  body {
    font-family: "Inter", sans-serif;
  }
</style>
